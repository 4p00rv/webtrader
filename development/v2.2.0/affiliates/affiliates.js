define(["exports","jquery","../navigation/menu","lodash","webtrader-charts","text!../charts/chartWindow.html","../instruments/instruments","../common/util","jquery-growl"],function(a,b,c,d,e,f,g){"use strict";function h(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(a,"__esModule",{value:!0}),a.init=void 0;var i=h(b),j=(h(c),h(d)),k=h(f),l=h(g),m=function(a,b,c,d,f,g,h){var i=a.attr("id"),j=e.tableView.init(a,p);e.chartOptions.init(i,b,c,j.show,d,f,!g,!h)},n=new RegExp(/^(GMT[\+|-])\d{1,2}(\.\d{1,2})*$/),o=getParameterByName("timezone").toUpperCase().replace(" ","+"),p=0;if(n.test(o)){var q=o.split("GMT")[1],r=parseInt(q.split(".")[0]),s=q.split(".")[1]?r>0?parseInt(q.split(".")[1]):-1*parseInt(q.split(".")[1]):0;p=-1*(60*r+s)}Highcharts.setOptions({global:{timezoneOffset:p},plotOptions:{candlestick:{lineColor:"rgba(0,0,0,1)",color:"rgba(215,24,24,1)",upColor:"rgba(2,146,14,1)",upLineColor:"rgba(0,0,0,1)"}}});var t=a.init=function(){i["default"]("body").addClass("affiliates");var a=getParameterByName("chartContainerID")||"webtrader-dialog-1",b=getParameterByName("timePeriod")||"1d",c="1t"==b?"line":"candlestick",d=i["default"](k["default"]).i18n();d.attr("id",a).find("div.chartSubContainerHeader").attr("id",a+"_header").end().find("div.chartSubContainer").attr("id",a+"_chart").end(),l["default"].init().then(function(f){if(!i["default"].isEmptyObject(f)){var g=getParameterByName("instrument"),h=getObjects(f,"symbol",g);if(h&&h.length>0&&h[0].symbol&&h[0].display_name)if(validateParameters()){var k=h[0].symbol,l=h[0].display_name,n=h[0].delay_amount||0,o=isHideOverlay(),p=isHideShare(),q={instrumentCode:k,instrumentName:l,timePeriod:b,type:c,delayAmount:n,name:a};e.chartWindow.add_chart_options(a,q),e.charts.drawChart("#"+a+"_chart",{instrumentCode:k,instrumentName:l,timePeriod:b,type:c,delayAmount:n}),m(d,b,c,l,k,p,o),j["default"].defer(function(){e.charts.triggerReflow("#"+a+"_chart"),i["default"]("#"+a).on("chart-time-period-changed",function(a,b){window.timePeriodChangeListener&&window.timePeriodChangeListener(b)})})}else i["default"].growl.error({message:"Invalid parameter(s)!".i18n()}),d.find("div.chartSubContainerHeader").hide();else i["default"].growl.error({message:"Instrument Code Unknown/Unavailable!".i18n()}),d.find("div.chartSubContainerHeader").hide()}})["catch"](function(a){i["default"].growl.error({message:"Error getting market information!".i18n()}),d.find("div.chartSubContainerHeader").hide()}),i["default"](".mainContainer").append(d),i["default"]("#"+a+" .chartSubContainer").height(i["default"](window).height()-50).width(i["default"](window).width()),i["default"]("#"+a+" .table-view").width(i["default"](window).width()),i["default"](window).resize(function(){i["default"]("#"+a+" .chartSubContainer").height(i["default"](window).height()-50).width(i["default"](window).width()),i["default"]("#"+a+" .table-view").width(i["default"](window).width())})};a["default"]={init:t}});