{"version":3,"sources":["../../../../src/cashier/currency.es6"],"names":["require","check_promise","check_currency_async","Promise","resolve","reject","$html","win","createBlankWindow","dialogClass","width","height","resizable","collapsable","minimizable","maximizable","modal","ignoreTileAction","close","dialog","remove","destroy","win_view","unbind","state","disabled","value","array","continue","send","set_account_currency","then","cancel","message","i18n","cached","payout_currencies","data","catch","bind","check_currency","up"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAMAA,UAAQ,CAAC,4BAAD,CAAR;;AAEA,MAAIC,gBAAgB,IAApB;AACA,MAAMC,uBAAuB,SAAvBA,oBAAuB;AAAA,WAAM,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAChE,UAAIC,QAAQ,yCAAZ;AACA,UAAIC,MAAM,kBAAQC,iBAAR,CAA0BF,KAA1B,EAAiC;AACvCG,qBAAa,gBAD0B;AAEvCC,eAAO,GAFgC;AAGvCC,gBAAQ,GAH+B;AAIvCC,mBAAW,KAJ4B;AAKvCC,qBAAa,KAL0B;AAMvCC,qBAAa,KAN0B;AAOvCC,qBAAa,KAP0B;AAQvCC,eAAO,IARgC;AASvCC,0BAAiB,IATsB;AAUvCC,eAAO,iBAAM;AACXX,cAAIY,MAAJ,CAAW,SAAX;AACAZ,cAAIa,MAAJ;AACAb,gBAAM,IAAN;AACD,SAdsC;AAevCc,iBAAS,mBAAM;AACbC,sBAAYA,SAASC,MAAT,EAAZ;AACAD,qBAAW,IAAX;AACD;AAlBsC,OAAjC,CAAV;;AAqBA,UAAIE,QAAQ;AACVC,kBAAU,IADA;AAEVC,eAAO,gBAFG;AAGVC,eAAO,CAAC,gBAAD,CAHG;AAIVC,kBAAU,qBAAM;AACdJ,gBAAMC,QAAN,GAAiB,IAAjB;AACA,sCAAQI,IAAR,CAAa,EAAEC,sBAAsBN,MAAME,KAA9B,EAAb,EACGK,IADH,CACQ3B,OADR,EACiBC,MADjB,EAEG0B,IAFH,CAEQ;AAAA,mBAAMxB,IAAIY,MAAJ,CAAW,OAAX,CAAN;AAAA,WAFR;AAGD,SATS;AAUVa,gBAAQ,kBAAM;AACZzB,cAAIY,MAAJ,CAAW,OAAX;AACAd,iBAAO,EAAE4B,SAAS,uBAAuBC,IAAvB,EAAX,EAAP;AACD;AAbS,OAAZ;AAeA,kCAAQC,MAAR,CAAeN,IAAf,CAAoB,EAACO,mBAAkB,CAAnB,EAApB,EAA2CL,IAA3C,CAAgD,UAACM,IAAD,EAAU;AACxDb,cAAMC,QAAN,GAAiB,KAAjB;AACAD,cAAMG,KAAN,GAAcU,KAAKD,iBAAnB;AACAZ,cAAME,KAAN,GAAcW,KAAKD,iBAAL,CAAuB,CAAvB,CAAd;AACD,OAJD,EAIGE,KAJH,CAIS;AAAA,eAAKjC,OAAO,EAAC4B,SAAS,sCAAsCC,IAAtC,EAAV,EAAP,CAAL;AAAA,OAJT;;AAMA,UAAIZ,WAAW,sBAAGiB,IAAH,CAAQjC,MAAM,CAAN,CAAR,EAAkBkB,KAAlB,CAAf;AACAjB,UAAIY,MAAJ,CAAW,MAAX;AACH,KA9CkC,CAAN;AAAA,GAA7B;;AAgDO,MAAMqB,0CAAiB,SAAjBA,cAAiB,GAAM;AAClC,QAAGvC,aAAH,EAAkB;AAAE,aAAOA,aAAP;AAAuB;AAC3CA,oBAAgBC,uBAAuBoC,KAAvB,CAA6B,cAAM;AACjDrC,sBAAgB,IAAhB;AACA,YAAMwC,EAAN;AACD,KAHe,CAAhB;AAIA,WAAOxC,aAAP;AACD,GAPM;;oBASQ;AACbuC;AADa,G","file":"currency.js","sourcesContent":["import $ from 'jquery';\nimport liveapi from 'websockets/binary_websockets';\nimport windows from 'windows/windows';\nimport rv from 'common/rivetsExtra';\nimport html from 'text!cashier/currency.html';\n\nrequire(['text!cashier/currency.html']);\n\nlet check_promise = null;\nconst check_currency_async = () => new Promise((resolve, reject) => {\n    var $html = $(html);\n    var win = windows.createBlankWindow($html, {\n        dialogClass: \"dialog-confirm\",\n        width: 500,\n        height: 230,\n        resizable: false,\n        collapsable: false,\n        minimizable: false,\n        maximizable: false,\n        modal: true,\n        ignoreTileAction:true,\n        close: () => {\n          win.dialog('destroy');\n          win.remove();\n          win = null;\n        },\n        destroy: () => {\n          win_view && win_view.unbind();\n          win_view = null;\n        }\n    });\n\n    var state = {\n      disabled: true,\n      value: 'Select a value',\n      array: ['Select a value'],\n      continue: () => {\n        state.disabled = true;\n        liveapi.send({ set_account_currency: state.value })\n          .then(resolve, reject)\n          .then(() => win.dialog('close'));\n      },\n      cancel: () => {\n        win.dialog('close');\n        reject({ message: 'Please set currency.'.i18n() });\n      }\n    };\n    liveapi.cached.send({payout_currencies:1}).then((data) => {\n      state.disabled = false;\n      state.array = data.payout_currencies;\n      state.value = data.payout_currencies[0];\n    }).catch(()=> reject({message: 'Please try again after few minutes.'.i18n()}));\n\n    var win_view = rv.bind($html[0], state);\n    win.dialog('open');\n});\n\nexport const check_currency = () => {\n  if(check_promise) { return check_promise; }\n  check_promise = check_currency_async().catch(up => {\n    check_promise = null;\n    throw up;\n  });\n  return check_promise;\n}\n\nexport default {\n  check_currency\n}\n"]}